# FeelMe REST API

RESTfull API provides access to the following resources:

- Applications
- Tips

## API endpoints

### Partner resource

All requests to do tips must be signed with partner token. 
Partner token is a string that must be obtained via the following API.

#### Get partner token

``GET /api/v1/partner/<partner-key>/token``

##### Parameters

URL parameter:
- ``<partner-key>`` is a secret key generated by feelme admin via
  admin interface. Please contact us to obtain the key.

##### Response (JSON)

    {
      partner_token: 'partner-token'
    }

The token is valid for 24 hours. Please note that each subsequent request can
return a different partner token. Multiple tokens obtained this way can be
valid at the same time as long as they are not expired.

For security reason, to avoid partner key exposure we recommend to
perform such requests from server side only, not from the client side.

### User resource

Represents external users (users registered on partners' websites)

#### Get user status

``GET /api/v1/user/<user-id>/status?partner_token=<partner-token>``

##### Parameters

URL parameter
- ``partner_token`` - partner token previously returned by 
    ``/api/v1/partner/<partner-key>/token`` request
- ``user-id`` - performer user id on the partner website, string, up to 
    1000 chars long. 

##### Response (JSON)

{
  user_id: 'user-id',
  authenticated: true | false,
  online: true | false
  devices: <device-list>
}

- ``user_id`` - performer user id, same as provided in request
- ``authenticated`` - ``true`` if user is known to FeelMe
- ``online`` - ``true`` if user is known and has the performer app running
- ``devices`` is a list of devices which are connected to the app 
    (e.g. ``['PEARL', 'ONYX']``) 

#### Request user authorization

``GET /api/v1/user/<user-id>/auth?partner_token=<partner-token>``

##### Parameters

URL parameter
- ``partner_token`` - partner token previously returned by 
    ``/api/v1/partner/<partner-key>/token`` request
- ``user-id`` - performer user id on the partner website, string, up to 
    1000 chars long. 

##### Response (JSON)

{
  auth_token: 'auth-token'
}

This request returns auth token which should be displayed as the QR code.

##### Possible errors

- ``401 NOT AUTHORIZED`` - partner token is invalid.

#### Send a tip to the user

``POST /api/v1/user/<user-id>/tip?partner_token=<partner-token>``

##### Parameters

URL parameters:
- ``user-id`` - performer user id on the partner website 
- ``partner_token`` - partner token previously returned by
    ``/api/v1/partner/<partner-key>/token`` request

POST parameters:
- ``sender`` - username of the person who sent the tip, string (e.g. ``John Doe``)
- ``amount`` - tip amount, string (e.g. ``10 coins``)
- ``duration`` - tip (vibration) duration in seconds, floating point number (e.g. ``2.5``) 
- ``strength`` - tip (vibration) strength in percents, integer (e.g. ``50``)

##### Possible errors

- ``404 NOT FOUND`` - user is offline or is not known to the FeelMe system.
    You should use ``/api/v1/user/<user-id>/status`` to see the reason
    why the tip cannot be sent.
- ``401 NOT AUTHORIZED`` - partner token is invalid.

#### Getting realtime resource 

``GET /api/v1/user/<user-id>/realtime?partner_token=<partner-token>``

##### Parameters

URL parameters:
- ``user-id`` - performer user id on the partner website 
- ``partner_token`` - partner token previously returned by
    ``/api/v1/partner/<partner-key>/token`` request

##### Response (JSON)

{
  realtime_resource_id: 'realtime-resource-id'
}

This request returns the realtime resource id which should be used with 
FellMe JavaScript SDK.

##### ERRORS

- ``404 NOT FOUND`` - user is not known to the FeelMe system.
- ``401 NOT AUTHORIZED`` - partner token is invalid.
